2025-05-05 15:31:45,281 - INFO - Loading data for valley detection testing...
2025-05-05 15:31:45,282 - INFO - Loading and merging data...
2025-05-05 15:31:45,369 - INFO - Loaded price data: (72983, 11)
2025-05-05 15:31:45,370 - INFO - Price data date range: 2017-01-01 00:00:00 to 2025-04-29 23:00:00
2025-05-05 15:31:45,462 - INFO - Grid data range after trimming: 2017-01-01 00:00:00 to 2025-04-29 23:00:00
2025-05-05 15:31:45,469 - INFO - Merged grid data: (68435, 19)
2025-05-05 15:31:45,771 - INFO - Merged time features: (72984, 10)
2025-05-05 15:31:46,347 - INFO - Merged holiday data: (72984, 4)
2025-05-05 15:31:46,461 - INFO - Weather data range after trimming: 2017-01-01 00:00:00 to 2025-04-29 23:00:00
2025-05-05 15:31:46,464 - INFO - Merged weather data: (72984, 7)
2025-05-05 15:31:46,489 - INFO - No missing values in merged dataframe - all data ranges properly aligned
2025-05-05 15:31:46,489 - INFO - Final merged dataframe shape: (72983, 50)
2025-05-05 15:31:46,489 - INFO - Date range: 2017-01-01 00:00:00 to 2025-04-29 23:00:00
2025-05-05 15:31:46,517 - INFO - Loaded data with 72983 rows
2025-05-05 15:31:46,518 - INFO - Applying derivative-based valley detection...
2025-05-05 15:31:47,885 - WARNING - Error processing valley candidate at 2020-10-25 02:00:00: unsupported operand type(s) for -: 'slice' and 'int'
2025-05-05 15:31:48,746 - WARNING - Error processing valley candidate at 2023-10-29 02:00:00: unsupported operand type(s) for -: 'slice' and 'int'
2025-05-05 15:31:50,190 - INFO - Added 1865 additional daily valleys
2025-05-05 15:32:19,608 - INFO - Added 8416 relative valleys between peaks
2025-05-05 15:32:22,053 - INFO - Detected 7691 derivative-based valleys (10.5% of data)
2025-05-05 15:32:22,053 - INFO - Using derivative method with slope_threshold=0.03, curvature_threshold=0.01, distance=2
2025-05-05 15:32:22,100 - INFO - Applying robust valley detection...
2025-05-05 15:32:25,158 - INFO - Robust valley detection found 15638 valleys (21.4% of data)
2025-05-05 15:32:25,160 - INFO - Derivative method detected 7691 valleys (10.5% of data)
2025-05-05 15:32:25,160 - INFO - Robust method detected 15638 valleys (21.4% of data)
2025-05-05 15:32:30,375 - INFO - Valley detection testing completed
