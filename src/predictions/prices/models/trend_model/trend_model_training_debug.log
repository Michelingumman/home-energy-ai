2025-05-06 12:48:00,264 - INFO - === STEP 1: DATA PREPARATION ===
2025-05-06 12:48:00,264 - INFO - Target variable: SE3_price_ore
2025-05-06 12:48:00,264 - INFO - Training data shape: (51104,)
2025-05-06 12:48:00,264 - INFO - Limiting training data to last 3.0 years for balanced training
2025-05-06 12:48:00,265 - INFO - Training data length: 26280
2025-05-06 12:48:00,265 - INFO - === STEP 2: FEATURE INSPECTION ===
2025-05-06 12:48:00,265 - INFO - Potential features: ['powerConsumptionTotal', 'powerProductionTotal', 'hydro', 'nuclear', 'wind', 'powerImportTotal', 'powerExportTotal', 'price_168h_avg', 'hour_avg_price', 'price_24h_avg']
2025-05-06 12:48:00,266 - INFO - Available features: ['powerConsumptionTotal', 'powerProductionTotal', 'hydro', 'nuclear', 'wind', 'powerImportTotal', 'powerExportTotal', 'price_168h_avg', 'hour_avg_price', 'price_24h_avg']
2025-05-06 12:48:00,266 - INFO - === STEP 3: ALIGNED DATA PREPARATION ===
2025-05-06 12:48:00,272 - INFO - Extracted training data shape: (26280, 41)
2025-05-06 12:48:00,274 - INFO - Prepared training data: X_train (26280, 10), y_train (26280,)
2025-05-06 12:48:00,275 - INFO - === STEP 4: TIME FEATURE ENGINEERING ===
2025-05-06 12:48:00,286 - INFO - Added time features, new X_train shape: (26280, 22)
2025-05-06 12:48:00,286 - INFO - === STEP 5: FEATURE IMPORTANCE WEIGHTING ===
2025-05-06 12:48:00,291 - INFO - Feature group 'core_price' correlations:
2025-05-06 12:48:00,291 - INFO -   price_168h_avg: 0.655
2025-05-06 12:48:00,291 - INFO -   hour_avg_price: 0.259
2025-05-06 12:48:00,291 - INFO -   price_24h_avg: 0.786
2025-05-06 12:48:00,292 - INFO - Feature group 'consumption' correlations:
2025-05-06 12:48:00,292 - INFO -   powerConsumptionTotal: 0.112
2025-05-06 12:48:00,292 - INFO - Feature group 'production' correlations:
2025-05-06 12:48:00,292 - INFO -   powerProductionTotal: -0.133
2025-05-06 12:48:00,292 - INFO -   hydro: -0.026
2025-05-06 12:48:00,292 - INFO -   nuclear: -0.020
2025-05-06 12:48:00,293 - INFO -   wind: -0.269
2025-05-06 12:48:00,293 - INFO - Feature group 'trade' correlations:
2025-05-06 12:48:00,293 - INFO -   powerImportTotal: 0.262
2025-05-06 12:48:00,293 - INFO -   powerExportTotal: 0.009
2025-05-06 12:48:00,293 - INFO - Feature group 'time' correlations:
2025-05-06 12:48:00,293 - INFO -   hour_avg_price: 0.259
2025-05-06 12:48:00,294 - INFO -   hour_sin: -0.086
2025-05-06 12:48:00,294 - INFO -   hour_cos: -0.182
2025-05-06 12:48:00,294 - INFO -   day_sin: -0.008
2025-05-06 12:48:00,294 - INFO -   day_cos: 0.022
2025-05-06 12:48:00,294 - INFO -   month_sin: -0.153
2025-05-06 12:48:00,295 - INFO -   month_cos: 0.001
2025-05-06 12:48:00,295 - INFO -   dayofweek_sin: 0.133
2025-05-06 12:48:00,295 - INFO -   dayofweek_cos: 0.009
2025-05-06 12:48:00,295 - INFO -   is_weekend: -0.150
2025-05-06 12:48:00,295 - INFO -   is_business_hour: 0.235
2025-05-06 12:48:00,295 - INFO -   is_morning_peak: 0.106
2025-05-06 12:48:00,295 - INFO -   is_evening_peak: 0.114
2025-05-06 12:48:00,295 - INFO - Features sorted by correlation with target price:
2025-05-06 12:48:00,296 - INFO -   price_24h_avg: 0.786
2025-05-06 12:48:00,296 - INFO -   price_168h_avg: 0.655
2025-05-06 12:48:00,296 - INFO -   wind: -0.269
2025-05-06 12:48:00,296 - INFO -   powerImportTotal: 0.262
2025-05-06 12:48:00,296 - INFO -   hour_avg_price: 0.259
2025-05-06 12:48:00,296 - INFO -   is_business_hour: 0.235
2025-05-06 12:48:00,296 - INFO -   hour_cos: -0.182
2025-05-06 12:48:00,297 - INFO -   month_sin: -0.153
2025-05-06 12:48:00,297 - INFO -   is_weekend: -0.150
2025-05-06 12:48:00,297 - INFO -   powerProductionTotal: -0.133
2025-05-06 12:48:00,298 - INFO -   dayofweek_sin: 0.133
2025-05-06 12:48:00,298 - INFO -   is_evening_peak: 0.114
2025-05-06 12:48:00,298 - INFO -   powerConsumptionTotal: 0.112
2025-05-06 12:48:00,298 - INFO -   is_morning_peak: 0.106
2025-05-06 12:48:00,298 - INFO -   hour_sin: -0.086
2025-05-06 12:48:00,298 - INFO -   hydro: -0.026
2025-05-06 12:48:00,298 - INFO -   day_cos: 0.022
2025-05-06 12:48:00,298 - INFO -   nuclear: -0.020
2025-05-06 12:48:00,299 - INFO -   dayofweek_cos: 0.009
2025-05-06 12:48:00,299 - INFO -   powerExportTotal: 0.009
2025-05-06 12:48:00,299 - INFO -   day_sin: -0.008
2025-05-06 12:48:00,299 - INFO -   month_cos: 0.001
2025-05-06 12:48:00,299 - INFO - === STEP 6: GRADIENT BOOSTING MODEL TRAINING ===
2025-05-06 12:48:00,310 - INFO - Training with 22 features and 26280 samples
2025-05-06 12:48:00,311 - INFO - Validation data: (10951, 22)
2025-05-06 12:48:00,311 - INFO - XGBoost parameters: {'objective': None, 'learning_rate': 0.05, 'max_depth': 20, 'min_child_weight': 5, 'gamma': 0.2, 'subsample': 0.7, 'colsample_bytree': 0.7, 'reg_alpha': 3.0, 'reg_lambda': 10.0, 'random_state': 42, 'n_jobs': -1}
2025-05-06 12:48:04,126 - INFO - Trained model with custom objective function
2025-05-06 12:48:04,126 - INFO - Training completed in 0:00:03
2025-05-06 12:48:04,127 - INFO - Best iteration: 60
2025-05-06 12:48:04,127 - INFO - Best score: 38.06460549357343
2025-05-06 12:48:04,128 - INFO - === STEP 7: FEATURE IMPORTANCE ANALYSIS ===
2025-05-06 12:48:04,133 - INFO - Top 20 important features:
2025-05-06 12:48:04,134 - INFO - 1. price_24h_avg: 128578.40
2025-05-06 12:48:04,134 - INFO - 2. hour_avg_price: 31495.89
2025-05-06 12:48:04,134 - INFO - 3. is_evening_peak: 25550.05
2025-05-06 12:48:04,134 - INFO - 4. price_168h_avg: 20677.69
2025-05-06 12:48:04,134 - INFO - 5. is_morning_peak: 18092.84
2025-05-06 12:48:04,135 - INFO - 6. month_sin: 12254.12
2025-05-06 12:48:04,135 - INFO - 7. is_weekend: 12035.32
2025-05-06 12:48:04,135 - INFO - 8. hydro: 11682.42
2025-05-06 12:48:04,135 - INFO - 9. hour_cos: 11396.26
2025-05-06 12:48:04,135 - INFO - 10. is_business_hour: 11002.69
2025-05-06 12:48:04,135 - INFO - 11. nuclear: 8717.08
2025-05-06 12:48:04,135 - INFO - 12. hour_sin: 8272.77
2025-05-06 12:48:04,136 - INFO - 13. wind: 7936.14
2025-05-06 12:48:04,136 - INFO - 14. dayofweek_cos: 6997.24
2025-05-06 12:48:04,136 - INFO - 15. dayofweek_sin: 6171.64
2025-05-06 12:48:04,136 - INFO - 16. month_cos: 5167.86
2025-05-06 12:48:04,136 - INFO - 17. powerConsumptionTotal: 4377.69
2025-05-06 12:48:04,136 - INFO - 18. powerImportTotal: 3489.83
2025-05-06 12:48:04,136 - INFO - 19. powerProductionTotal: 3463.54
2025-05-06 12:48:04,137 - INFO - 20. day_cos: 3216.73
2025-05-06 12:48:04,137 - INFO - === STEP 8: VALIDATION PREDICTIONS WITH SMOOTHING ===
2025-05-06 12:48:04,155 - INFO - Applying smoothing pipeline to predictions
2025-05-06 12:48:04,155 - INFO - Using heavy smoothing level
2025-05-06 12:48:04,190 - INFO - Validation metrics: MAE=37.27, RMSE=51.48, Direction Accuracy=0.55
2025-05-06 12:48:04,190 - INFO - === STEP 9: MODEL SAVING ===
2025-05-06 12:48:04,250 - INFO - Successfully saved model to C:\_Projects\home-energy-ai\src\predictions\prices\models\trend_model\best_trend_model.pkl (11280537 bytes)
2025-05-06 12:48:04,251 - INFO - Saved feature names to C:\_Projects\home-energy-ai\src\predictions\prices\models\trend_model\feature_names.json
2025-05-06 12:48:04,252 - INFO - Saved model parameters to C:\_Projects\home-energy-ai\src\predictions\prices\models\trend_model\trend_model_params.json
2025-05-06 12:48:04,782 - INFO - Saved feature importance plot to C:\_Projects\home-energy-ai\src\predictions\prices\plots\evaluation\trend\feature_importance.png
2025-05-06 12:48:05,093 - INFO - Saved validation prediction plot to C:\_Projects\home-energy-ai\src\predictions\prices\plots\evaluation\trend\validation_prediction.png
2025-05-06 12:48:05,258 - INFO - Saved weekly validation plot to C:\_Projects\home-energy-ai\src\predictions\prices\plots\evaluation\trend\validation_prediction_week.png
2025-05-06 12:48:05,258 - INFO - XGBoost trend model training completed
2025-05-06 12:48:05,259 - INFO - Trend model training complete with metrics: {'val_mae': 37.267824177747215, 'val_rmse': 51.481587317687854, 'val_direction_accuracy': 0.5493150684931507}
2025-05-06 12:48:05,259 - INFO - trend model training completed successfully
2025-05-06 12:48:16,943 - INFO - === STEP 1: DATA PREPARATION ===
2025-05-06 12:48:16,943 - INFO - Target variable: SE3_price_ore
2025-05-06 12:48:16,943 - INFO - Training data shape: (73007,)
2025-05-06 12:48:16,944 - INFO - Training data length: 73007
2025-05-06 12:48:16,944 - INFO - === STEP 2: FEATURE INSPECTION ===
2025-05-06 12:48:16,944 - INFO - Potential features: ['powerConsumptionTotal', 'powerProductionTotal', 'hydro', 'nuclear', 'wind', 'powerImportTotal', 'powerExportTotal', 'price_168h_avg', 'hour_avg_price', 'price_24h_avg']
2025-05-06 12:48:16,944 - INFO - Available features: ['powerConsumptionTotal', 'powerProductionTotal', 'hydro', 'nuclear', 'wind', 'powerImportTotal', 'powerExportTotal', 'price_168h_avg', 'hour_avg_price', 'price_24h_avg']
2025-05-06 12:48:16,944 - INFO - === STEP 3: ALIGNED DATA PREPARATION ===
2025-05-06 12:48:16,955 - INFO - Extracted training data shape: (73007, 41)
2025-05-06 12:48:16,957 - INFO - Prepared training data: X_train (73007, 10), y_train (73007,)
2025-05-06 12:48:16,958 - INFO - === STEP 4: TIME FEATURE ENGINEERING ===
2025-05-06 12:48:16,976 - INFO - Added time features, new X_train shape: (73007, 22)
2025-05-06 12:48:16,976 - INFO - === STEP 5: FEATURE IMPORTANCE WEIGHTING ===
2025-05-06 12:48:16,985 - INFO - Feature group 'core_price' correlations:
2025-05-06 12:48:16,985 - INFO -   price_168h_avg: 0.709
2025-05-06 12:48:16,985 - INFO -   hour_avg_price: 0.207
2025-05-06 12:48:16,985 - INFO -   price_24h_avg: 0.828
2025-05-06 12:48:16,986 - INFO - Feature group 'consumption' correlations:
2025-05-06 12:48:16,986 - INFO -   powerConsumptionTotal: 0.311
2025-05-06 12:48:16,986 - INFO - Feature group 'production' correlations:
2025-05-06 12:48:16,986 - INFO -   powerProductionTotal: 0.034
2025-05-06 12:48:16,986 - INFO -   hydro: 0.098
2025-05-06 12:48:16,986 - INFO -   nuclear: 0.079
2025-05-06 12:48:16,986 - INFO -   wind: -0.184
2025-05-06 12:48:16,986 - INFO - Feature group 'trade' correlations:
2025-05-06 12:48:16,987 - INFO -   powerImportTotal: 0.327
2025-05-06 12:48:16,987 - INFO -   powerExportTotal: 0.038
2025-05-06 12:48:16,987 - INFO - Feature group 'time' correlations:
2025-05-06 12:48:16,987 - INFO -   hour_avg_price: 0.207
2025-05-06 12:48:16,988 - INFO -   hour_sin: -0.069
2025-05-06 12:48:16,988 - INFO -   hour_cos: -0.141
2025-05-06 12:48:16,988 - INFO -   day_sin: 0.016
2025-05-06 12:48:16,988 - INFO -   day_cos: 0.002
2025-05-06 12:48:16,988 - INFO -   month_sin: -0.034
2025-05-06 12:48:16,988 - INFO -   month_cos: 0.130
2025-05-06 12:48:16,988 - INFO -   dayofweek_sin: 0.110
2025-05-06 12:48:16,988 - INFO -   dayofweek_cos: -0.001
2025-05-06 12:48:16,988 - INFO -   is_weekend: -0.125
2025-05-06 12:48:16,989 - INFO -   is_business_hour: 0.188
2025-05-06 12:48:16,989 - INFO -   is_morning_peak: 0.089
2025-05-06 12:48:16,989 - INFO -   is_evening_peak: 0.095
2025-05-06 12:48:16,989 - INFO - Features sorted by correlation with target price:
2025-05-06 12:48:16,989 - INFO -   price_24h_avg: 0.828
2025-05-06 12:48:16,989 - INFO -   price_168h_avg: 0.709
2025-05-06 12:48:16,989 - INFO -   powerImportTotal: 0.327
2025-05-06 12:48:16,990 - INFO -   powerConsumptionTotal: 0.311
2025-05-06 12:48:16,990 - INFO -   hour_avg_price: 0.207
2025-05-06 12:48:16,990 - INFO -   is_business_hour: 0.188
2025-05-06 12:48:16,990 - INFO -   wind: -0.184
2025-05-06 12:48:16,990 - INFO -   hour_cos: -0.141
2025-05-06 12:48:16,990 - INFO -   month_cos: 0.130
2025-05-06 12:48:16,990 - INFO -   is_weekend: -0.125
2025-05-06 12:48:16,990 - INFO -   dayofweek_sin: 0.110
2025-05-06 12:48:16,991 - INFO -   hydro: 0.098
2025-05-06 12:48:16,991 - INFO -   is_evening_peak: 0.095
2025-05-06 12:48:16,991 - INFO -   is_morning_peak: 0.089
2025-05-06 12:48:16,991 - INFO -   nuclear: 0.079
2025-05-06 12:48:16,991 - INFO -   hour_sin: -0.069
2025-05-06 12:48:16,991 - INFO -   powerExportTotal: 0.038
2025-05-06 12:48:16,991 - INFO -   powerProductionTotal: 0.034
2025-05-06 12:48:16,991 - INFO -   month_sin: -0.034
2025-05-06 12:48:16,992 - INFO -   day_sin: 0.016
2025-05-06 12:48:16,992 - INFO -   day_cos: 0.002
2025-05-06 12:48:16,992 - INFO -   dayofweek_cos: -0.001
2025-05-06 12:48:16,992 - INFO - === STEP 6: GRADIENT BOOSTING MODEL TRAINING ===
2025-05-06 12:48:17,004 - INFO - Training with 22 features and 73007 samples
2025-05-06 12:48:17,004 - INFO - Validation data: (10951, 22)
2025-05-06 12:48:17,004 - INFO - XGBoost parameters: {'objective': None, 'learning_rate': 0.05, 'max_depth': 20, 'min_child_weight': 5, 'gamma': 0.2, 'subsample': 0.7, 'colsample_bytree': 0.7, 'reg_alpha': 3.0, 'reg_lambda': 10.0, 'random_state': 42, 'n_jobs': -1}
2025-05-06 12:48:50,797 - INFO - Trained model with custom objective function
2025-05-06 12:48:50,798 - INFO - Training completed in 0:00:33
2025-05-06 12:48:50,798 - INFO - Best iteration: 999
2025-05-06 12:48:50,798 - INFO - Best score: 0.4050216276464934
2025-05-06 12:48:50,799 - INFO - === STEP 7: FEATURE IMPORTANCE ANALYSIS ===
2025-05-06 12:48:50,878 - INFO - Top 20 important features:
2025-05-06 12:48:50,879 - INFO - 1. price_24h_avg: 17816.13
2025-05-06 12:48:50,880 - INFO - 2. price_168h_avg: 8885.17
2025-05-06 12:48:50,881 - INFO - 3. is_business_hour: 7080.47
2025-05-06 12:48:50,881 - INFO - 4. hour_avg_price: 3565.19
2025-05-06 12:48:50,881 - INFO - 5. is_morning_peak: 3233.07
2025-05-06 12:48:50,882 - INFO - 6. is_weekend: 2771.99
2025-05-06 12:48:50,882 - INFO - 7. nuclear: 2598.09
2025-05-06 12:48:50,882 - INFO - 8. is_evening_peak: 2175.90
2025-05-06 12:48:50,883 - INFO - 9. month_cos: 1960.65
2025-05-06 12:48:50,883 - INFO - 10. month_sin: 1890.12
2025-05-06 12:48:50,883 - INFO - 11. hydro: 1765.58
2025-05-06 12:48:50,883 - INFO - 12. hour_cos: 1182.42
2025-05-06 12:48:50,883 - INFO - 13. dayofweek_cos: 1126.75
2025-05-06 12:48:50,883 - INFO - 14. hour_sin: 1032.65
2025-05-06 12:48:50,883 - INFO - 15. powerConsumptionTotal: 961.62
2025-05-06 12:48:50,884 - INFO - 16. wind: 950.71
2025-05-06 12:48:50,884 - INFO - 17. dayofweek_sin: 909.61
2025-05-06 12:48:50,884 - INFO - 18. powerImportTotal: 825.50
2025-05-06 12:48:50,884 - INFO - 19. powerProductionTotal: 799.68
2025-05-06 12:48:50,884 - INFO - 20. day_sin: 698.15
2025-05-06 12:48:50,884 - INFO - === STEP 8: VALIDATION PREDICTIONS WITH SMOOTHING ===
2025-05-06 12:48:51,018 - INFO - Applying smoothing pipeline to predictions
2025-05-06 12:48:51,019 - INFO - Using heavy smoothing level
2025-05-06 12:48:51,052 - INFO - Validation metrics: MAE=26.63, RMSE=40.30, Direction Accuracy=0.55
2025-05-06 12:48:51,052 - INFO - === STEP 9: MODEL SAVING ===
2025-05-06 12:48:51,667 - INFO - Successfully saved model to C:\_Projects\home-energy-ai\src\predictions\prices\models\trend_model\best_trend_model.pkl (138665792 bytes)
2025-05-06 12:48:51,669 - INFO - Saved feature names to C:\_Projects\home-energy-ai\src\predictions\prices\models\trend_model\feature_names.json
2025-05-06 12:48:51,672 - INFO - Saved model parameters to C:\_Projects\home-energy-ai\src\predictions\prices\models\trend_model\trend_model_params.json
2025-05-06 12:48:51,978 - INFO - Saved feature importance plot to C:\_Projects\home-energy-ai\src\predictions\prices\plots\evaluation\trend\feature_importance.png
2025-05-06 12:48:52,276 - INFO - Saved validation prediction plot to C:\_Projects\home-energy-ai\src\predictions\prices\plots\evaluation\trend\validation_prediction.png
2025-05-06 12:48:52,444 - INFO - Saved weekly validation plot to C:\_Projects\home-energy-ai\src\predictions\prices\plots\evaluation\trend\validation_prediction_week.png
2025-05-06 12:48:52,445 - INFO - XGBoost trend model training completed
2025-05-06 12:48:52,447 - INFO - Trend model training complete with metrics: {'val_mae': 26.631413170864175, 'val_rmse': 40.298710590038766, 'val_direction_accuracy': 0.5534246575342465}
2025-05-06 12:48:52,447 - INFO - trend model training completed successfully
