2025-05-06 15:47:25,516 - INFO - Starting merged model evaluation (trend + valley)...
2025-05-06 15:47:25,517 - INFO - Loading data...
2025-05-06 15:47:25,630 - INFO - Loaded price data with shape (73007, 11)
2025-05-06 15:47:25,719 - INFO - Loaded grid data with shape (73132, 19)
2025-05-06 15:47:26,014 - INFO - Loaded time features with shape (289296, 10)
2025-05-06 15:47:26,531 - INFO - Loaded holidays data with shape (710017, 4)
2025-05-06 15:47:26,646 - INFO - Loaded weather data with shape (73080, 6)
2025-05-06 15:47:29,883 - INFO - Robust valley detection found 14059 valleys (19.3% of data)
2025-05-06 15:47:29,886 - INFO - Identified 14059 valleys (19.3% of data) using robust valley detection
2025-05-06 15:47:29,887 - INFO - Final merged data shape: (73007, 65)
2025-05-06 15:47:29,889 - INFO - Loading trend model...
2025-05-06 15:47:29,889 - INFO - Searching for trend models...
2025-05-06 15:47:29,890 - INFO - Using best trend model: C:\_Projects\home-energy-ai\src\predictions\prices\models\trend_model\best_trend_model.pkl
2025-05-06 15:47:29,890 - INFO - Loaded parameters for XGBoost model
2025-05-06 15:47:30,391 - INFO - Successfully loaded model from C:\_Projects\home-energy-ai\src\predictions\prices\models\trend_model\best_trend_model.pkl
2025-05-06 15:47:30,392 - INFO - Loaded feature order list with 22 features
2025-05-06 15:47:30,392 - INFO - Model uses 22 features
2025-05-06 15:47:30,392 - INFO - Top features: ['price_24h_avg', 'price_168h_avg', 'is_business_hour', 'hour_avg_price', 'is_morning_peak']
2025-05-06 15:47:30,392 - INFO - Loading valley model...
2025-05-06 15:47:30,393 - INFO - Loading valley detection model...
2025-05-06 15:47:30,393 - INFO - Using model from best_valley_model.keras
2025-05-06 15:47:31,415 - WARNING - From C:\Users\adamm\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\keras\src\backend\tensorflow\core.py:216: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2025-05-06 15:47:31,571 - INFO - Loaded valley model from C:\_Projects\home-energy-ai\src\predictions\prices\models\valley_model\best_valley_model.keras
2025-05-06 15:47:31,572 - INFO - Loaded feature list with 27 features
2025-05-06 15:47:31,572 - INFO - Loaded feature scaler from C:\_Projects\home-energy-ai\src\predictions\prices\models\valley_model\feature_scaler_valley_model.save
2025-05-06 15:47:31,573 - INFO - Starting combined trend and valley model evaluation...
2025-05-06 15:47:31,601 - INFO - Using validation data with 14601 rows from 2021-12-31 05:00:00+00:00 to 2023-08-31 14:00:00+00:00
2025-05-06 15:47:31,602 - INFO - Adding specialized features for valley detection...
2025-05-06 15:47:31,615 - INFO - Making trend predictions...
2025-05-06 15:47:31,615 - INFO - Adding time features for trend model...
2025-05-06 15:47:31,631 - INFO - Making predictions with trend model using 22 features...
2025-05-06 15:47:31,632 - INFO - Creating DMatrix without feature names to avoid mismatch
2025-05-06 15:47:31,827 - INFO - Successfully generated trend predictions with shape (14601,)
2025-05-06 15:47:31,869 - INFO - Making valley predictions with threshold 0.6...
2025-05-06 15:47:35,843 - INFO - Truncating trend predictions to match valley predictions: 14601 -> 14410
2025-05-06 15:47:35,844 - WARNING - Length mismatch between actual_valleys (14433) and valley_predictions (14410)
2025-05-06 15:47:35,845 - INFO - Truncated arrays to common length: 14410
2025-05-06 15:47:35,846 - INFO - Generating visualizations for 100 weeks...
2025-05-06 15:47:36,641 - INFO - Generated visualization for week starting 2022-01-07
2025-05-06 15:47:37,504 - INFO - Generated visualization for week starting 2022-01-14
2025-05-06 15:47:38,212 - INFO - Generated visualization for week starting 2022-01-21
2025-05-06 15:47:38,936 - INFO - Generated visualization for week starting 2022-01-28
2025-05-06 15:47:39,707 - INFO - Generated visualization for week starting 2022-02-04
2025-05-06 15:47:40,521 - INFO - Generated visualization for week starting 2022-02-11
2025-05-06 15:47:41,646 - INFO - Generated visualization for week starting 2022-02-18
2025-05-06 15:47:42,430 - INFO - Generated visualization for week starting 2022-02-25
2025-05-06 15:47:43,242 - INFO - Generated visualization for week starting 2022-03-04
2025-05-06 15:47:44,049 - INFO - Generated visualization for week starting 2022-03-11
2025-05-06 15:47:45,220 - INFO - Generated visualization for week starting 2022-03-18
2025-05-06 15:47:46,025 - INFO - Generated visualization for week starting 2022-03-25
2025-05-06 15:47:46,845 - INFO - Generated visualization for week starting 2022-04-01
2025-05-06 15:47:47,678 - INFO - Generated visualization for week starting 2022-04-08
2025-05-06 15:47:48,766 - INFO - Generated visualization for week starting 2022-04-15
2025-05-06 15:47:49,547 - INFO - Generated visualization for week starting 2022-04-22
2025-05-06 15:47:50,339 - INFO - Generated visualization for week starting 2022-04-29
2025-05-06 15:47:51,126 - INFO - Generated visualization for week starting 2022-05-06
2025-05-06 15:47:51,932 - INFO - Generated visualization for week starting 2022-05-13
2025-05-06 15:47:52,943 - INFO - Generated visualization for week starting 2022-05-20
2025-05-06 15:47:53,717 - INFO - Generated visualization for week starting 2022-05-27
2025-05-06 15:47:54,449 - INFO - Generated visualization for week starting 2022-06-03
2025-05-06 15:47:55,189 - INFO - Generated visualization for week starting 2022-06-10
2025-05-06 15:47:56,171 - INFO - Generated visualization for week starting 2022-06-17
2025-05-06 15:47:56,918 - INFO - Generated visualization for week starting 2022-06-24
2025-05-06 15:47:57,614 - INFO - Generated visualization for week starting 2022-07-01
2025-05-06 15:47:58,330 - INFO - Generated visualization for week starting 2022-07-08
2025-05-06 15:47:59,046 - INFO - Generated visualization for week starting 2022-07-15
2025-05-06 15:48:00,002 - INFO - Generated visualization for week starting 2022-07-22
2025-05-06 15:48:00,715 - INFO - Generated visualization for week starting 2022-07-29
2025-05-06 15:48:01,454 - INFO - Generated visualization for week starting 2022-08-05
2025-05-06 15:48:02,173 - INFO - Generated visualization for week starting 2022-08-12
2025-05-06 15:48:02,839 - INFO - Generated visualization for week starting 2022-08-19
2025-05-06 15:48:03,736 - INFO - Generated visualization for week starting 2022-08-26
2025-05-06 15:48:04,431 - INFO - Generated visualization for week starting 2022-09-02
2025-05-06 15:48:05,180 - INFO - Generated visualization for week starting 2022-09-09
2025-05-06 15:48:05,859 - INFO - Generated visualization for week starting 2022-09-16
2025-05-06 15:48:06,553 - INFO - Generated visualization for week starting 2022-09-23
2025-05-06 15:48:07,507 - INFO - Generated visualization for week starting 2022-09-30
2025-05-06 15:48:08,203 - INFO - Generated visualization for week starting 2022-10-07
2025-05-06 15:48:08,883 - INFO - Generated visualization for week starting 2022-10-14
2025-05-06 15:48:09,619 - INFO - Generated visualization for week starting 2022-10-21
2025-05-06 15:48:10,353 - INFO - Generated visualization for week starting 2022-10-28
2025-05-06 15:48:11,262 - INFO - Generated visualization for week starting 2022-11-04
2025-05-06 15:48:11,925 - INFO - Generated visualization for week starting 2022-11-11
2025-05-06 15:48:12,571 - INFO - Generated visualization for week starting 2022-11-18
2025-05-06 15:48:13,191 - INFO - Generated visualization for week starting 2022-11-25
2025-05-06 15:48:13,815 - INFO - Generated visualization for week starting 2022-12-02
2025-05-06 15:48:14,649 - INFO - Generated visualization for week starting 2022-12-09
2025-05-06 15:48:15,271 - INFO - Generated visualization for week starting 2022-12-16
2025-05-06 15:48:15,992 - INFO - Generated visualization for week starting 2022-12-23
2025-05-06 15:48:16,602 - INFO - Generated visualization for week starting 2022-12-30
2025-05-06 15:48:17,254 - INFO - Generated visualization for week starting 2023-01-06
2025-05-06 15:48:17,900 - INFO - Generated visualization for week starting 2023-01-13
2025-05-06 15:48:18,807 - INFO - Generated visualization for week starting 2023-01-20
2025-05-06 15:48:19,447 - INFO - Generated visualization for week starting 2023-01-27
2025-05-06 15:48:20,132 - INFO - Generated visualization for week starting 2023-02-03
2025-05-06 15:48:20,824 - INFO - Generated visualization for week starting 2023-02-10
2025-05-06 15:48:21,545 - INFO - Generated visualization for week starting 2023-02-17
2025-05-06 15:48:22,654 - INFO - Generated visualization for week starting 2023-02-24
2025-05-06 15:48:23,502 - INFO - Generated visualization for week starting 2023-03-03
2025-05-06 15:48:24,317 - INFO - Generated visualization for week starting 2023-03-10
2025-05-06 15:48:25,167 - INFO - Generated visualization for week starting 2023-03-17
2025-05-06 15:48:26,298 - INFO - Generated visualization for week starting 2023-03-24
2025-05-06 15:48:27,165 - INFO - Generated visualization for week starting 2023-03-31
2025-05-06 15:48:27,984 - INFO - Generated visualization for week starting 2023-04-07
2025-05-06 15:48:28,816 - INFO - Generated visualization for week starting 2023-04-14
2025-05-06 15:48:29,934 - INFO - Generated visualization for week starting 2023-04-21
2025-05-06 15:48:30,751 - INFO - Generated visualization for week starting 2023-04-28
2025-05-06 15:48:31,560 - INFO - Generated visualization for week starting 2023-05-05
2025-05-06 15:48:32,353 - INFO - Generated visualization for week starting 2023-05-12
2025-05-06 15:48:33,146 - INFO - Generated visualization for week starting 2023-05-19
2025-05-06 15:48:34,259 - INFO - Generated visualization for week starting 2023-05-26
2025-05-06 15:48:35,069 - INFO - Generated visualization for week starting 2023-06-02
2025-05-06 15:48:35,861 - INFO - Generated visualization for week starting 2023-06-09
2025-05-06 15:48:36,644 - INFO - Generated visualization for week starting 2023-06-16
2025-05-06 15:48:37,732 - INFO - Generated visualization for week starting 2023-06-23
2025-05-06 15:48:38,484 - INFO - Generated visualization for week starting 2023-06-30
2025-05-06 15:48:39,258 - INFO - Generated visualization for week starting 2023-07-07
2025-05-06 15:48:40,014 - INFO - Generated visualization for week starting 2023-07-14
2025-05-06 15:48:41,131 - INFO - Generated visualization for week starting 2023-07-21
2025-05-06 15:48:41,907 - INFO - Generated visualization for week starting 2023-07-28
2025-05-06 15:48:42,715 - INFO - Generated visualization for week starting 2023-08-04
2025-05-06 15:48:43,516 - INFO - Generated visualization for week starting 2023-08-11
2025-05-06 15:48:44,293 - INFO - Generated visualization for week starting 2023-08-18
2025-05-06 15:48:44,315 - INFO - Merged model evaluation complete.
