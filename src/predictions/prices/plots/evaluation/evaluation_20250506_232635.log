2025-05-06 23:26:35,894 - INFO - Loaded price data with shape (73007, 11)
2025-05-06 23:26:35,985 - INFO - Loaded grid data with shape (73147, 19)
2025-05-06 23:26:36,264 - INFO - Loaded time features with shape (289296, 10)
2025-05-06 23:26:36,756 - INFO - Loaded holidays data with shape (710017, 4)
2025-05-06 23:26:36,870 - INFO - Loaded weather data with shape (73080, 6)
2025-05-06 23:26:39,900 - INFO - Robust valley detection found 14059 valleys (19.3% of data)
2025-05-06 23:26:39,903 - INFO - Identified 14059 valleys (19.3% of data) using robust valley detection
2025-05-06 23:26:39,905 - INFO - Final merged data shape: (73007, 65)
2025-05-06 23:26:39,908 - INFO - Loaded data with 73007 samples
2025-05-06 23:26:39,909 - INFO - Loading peak detection model...
2025-05-06 23:26:39,910 - INFO - Using model from best_peak_model.keras
2025-05-06 23:26:40,789 - WARNING - From C:\Users\adamm\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\keras\src\backend\tensorflow\core.py:216: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2025-05-06 23:26:41,080 - INFO - Loaded peak model from C:\_Projects\home-energy-ai\src\predictions\prices\models\peak_model\best_peak_model.keras without compilation
2025-05-06 23:26:41,080 - INFO - Loaded feature list with 23 features
2025-05-06 23:26:41,081 - INFO - Loaded feature scaler from C:\_Projects\home-energy-ai\src\predictions\prices\models\peak_model\feature_scaler_peak_model.save
2025-05-06 23:26:41,081 - INFO - Evaluating peak detection model...
2025-05-06 23:26:41,081 - INFO - Evaluating on validation data...
2025-05-06 23:26:41,085 - INFO - Evaluation data: 14601 samples from 2021-12-31 04:00:00+00:00 to 2023-08-31 13:00:00+00:00
2025-05-06 23:26:41,101 - INFO - Creating sequences with lookback window of 168
2025-05-06 23:26:41,190 - INFO - Making predictions with model on 14433 samples...
2025-05-06 23:26:41,191 - INFO - Input shape: (14433, 168, 23)
2025-05-06 23:26:48,798 - INFO - Successfully made predictions with shape (14433, 1)
2025-05-06 23:26:48,798 - INFO - Using default probability threshold: 0.5
2025-05-06 23:26:48,858 - INFO - Peak model metrics:
2025-05-06 23:26:48,859 - INFO -   Accuracy: 0.7837
2025-05-06 23:26:48,859 - INFO -   Precision: 0.1751
2025-05-06 23:26:48,859 - INFO -   Recall: 0.9208
2025-05-06 23:26:48,859 - INFO -   F1 Score: 0.2943
2025-05-06 23:26:48,859 - INFO -   True Positives: 651, False Positives: 3066
2025-05-06 23:26:48,859 - INFO -   False Negatives: 56, True Negatives: 10660
2025-05-06 23:27:35,237 - INFO - Peak model evaluation complete
