2025-05-06 13:59:59,909 - INFO - Starting valley model evaluation with 4 weeks of visualizations...
2025-05-06 13:59:59,909 - INFO - Loading data...
2025-05-06 14:00:00,176 - INFO - Loaded price data with shape (73007, 11)
2025-05-06 14:00:00,462 - INFO - Loaded grid data with shape (73132, 19)
2025-05-06 14:00:01,525 - INFO - Loaded time features with shape (289296, 10)
2025-05-06 14:00:03,442 - INFO - Loaded holidays data with shape (710017, 4)
2025-05-06 14:00:03,845 - INFO - Loaded weather data with shape (73080, 6)
2025-05-06 14:00:13,519 - INFO - Robust valley detection found 14059 valleys (19.3% of data)
2025-05-06 14:00:13,527 - INFO - Identified 14059 valleys (19.3% of data) using robust valley detection
2025-05-06 14:00:13,529 - INFO - Final merged data shape: (73007, 65)
2025-05-06 14:00:13,534 - INFO - Starting valley model evaluation...
2025-05-06 14:00:13,535 - INFO - Loading valley model...
2025-05-06 14:00:13,535 - INFO - Loading valley detection model...
2025-05-06 14:00:13,537 - INFO - Using model from best_f1_valley_model.keras
2025-05-06 14:00:17,709 - WARNING - From C:\Users\adamm\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\keras\src\backend\tensorflow\core.py:216: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2025-05-06 14:00:18,338 - INFO - Loaded valley model from C:\_Projects\home-energy-ai\src\predictions\prices\models\valley_model\best_f1_valley_model.keras
2025-05-06 14:00:18,339 - INFO - Loaded feature list with 27 features
2025-05-06 14:00:18,340 - INFO - Loaded feature scaler from C:\_Projects\home-energy-ai\src\predictions\prices\models\valley_model\feature_scaler_valley_model.save
2025-05-06 14:00:18,341 - INFO - Evaluating valley detection model on validation data...
2025-05-06 14:00:18,341 - INFO - Using probability threshold: 0.5000
2025-05-06 14:00:18,341 - INFO - Adding specialized features for valley detection...
2025-05-06 14:00:18,553 - INFO - Using 672 validation samples for evaluation
2025-05-06 14:00:21,454 - INFO - Valley detection validation metrics (threshold=0.5000):
2025-05-06 14:00:21,455 - INFO -   Accuracy: 0.8462
2025-05-06 14:00:21,455 - INFO -   Precision: 0.0000
2025-05-06 14:00:21,456 - INFO -   Recall: 0.0000
2025-05-06 14:00:21,456 - INFO -   F1 Score: 0.0000
2025-05-06 14:00:21,456 - INFO -   ROC AUC: 0.5025
2025-05-06 14:00:21,457 - INFO -   Actual valley rate: 0.1538 (74 valleys)
2025-05-06 14:00:21,457 - INFO -   Predicted valley rate: 0.0000 (0 valleys)
2025-05-06 14:00:21,459 - INFO - Data dimensions: timestamps 481, predictions (481,), probabilities (481,), actuals (481,), prices (481,)
2025-05-06 14:00:23,967 - INFO - Generated visualization for week starting 2024-01-08
2025-05-06 14:00:26,635 - INFO - Generated visualization for week starting 2024-01-15
2025-05-06 14:00:28,935 - INFO - Generated visualization for week starting 2024-01-22
2025-05-06 14:00:28,937 - WARNING - Skipping week 2024-01-29 - insufficient data (only 16 hours)
2025-05-06 14:00:28,946 - INFO - Valley model evaluation complete.
2025-05-06 14:00:28,955 - INFO - Valley model evaluation completed successfully.
